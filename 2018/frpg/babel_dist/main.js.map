{"version":3,"sources":["../src/main.js"],"names":["sendNewPost","forEach","arr","f","Array","prototype","slice","call","renderDOM","console","log","document","body","offsetWidth","showArticleCard","cardHTML","card","createElement","classList","add","innerHTML","querySelector","appendChild","querySelectorAll","el","remove","showCard","articleName","articleMarkDown","articles","test","marked","trim","transitPage","newPage","history","pushState","setPageTransitionButtonEvent","sidebarItem","id","addEventListener","startLoadingGifAnimation","secondImage","img","Image","onload","style","backgroundImage","src","isValidPostContent","titleEl","bodyEl","error","alert","value","length","xhr","XMLHttpRequest","onreadystatechange","readyState","open","send","JSON","stringify","command","title","params","URLSearchParams","location","search","has","get","window","onpopstate","e"],"mappings":"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","sourcesContent":["let sendNewPost /*: () => void */;\r\n\r\n{\r\n    // IE対応\r\n    const forEach = (arr /*: any */, f /*: (el: any) => void */)/*: void */ => {\r\n        Array.prototype.slice.call(arr, 0).forEach(f);\r\n    };\r\n\r\n    // 強制的にレンダリング\r\n    const renderDOM = ()/*: void */ => {\r\n        console.log(document.body.offsetWidth);\r\n    };\r\n\r\n    const showArticleCard = (cardHTML /*: string */)/*: void */ => {\r\n        // カードを表示\r\n        const card = document.createElement('div');\r\n        card.classList.add(\r\n            'card', 'card-preload', 'scale-when-hover', 'markdown-body');\r\n        card.innerHTML = cardHTML;\r\n        document.querySelector(\"#article\").innerHTML = '';\r\n        document.querySelector(\"#article\").appendChild(card);\r\n\r\n        // アニメーションをスタート\r\n        renderDOM();\r\n        forEach(document.querySelectorAll(\".card-preload\"), (el) => {\r\n            el.classList.remove(\"card-preload\");\r\n        });\r\n    };\r\n\r\n    const showCard = (articleName /*: string */)/*: string */ => {\r\n        const articleMarkDown = articles[articleName];\r\n        if (typeof articleMarkDown !== \"string\" ||\r\n                /^\\s*$/.test(articles[articleName])) {\r\n            document.querySelector(\"#article\").innerHTML = \"\";\r\n            return \"top_page\";\r\n        } else {\r\n            showArticleCard(marked(articles[articleName].trim()));\r\n            return articleName\r\n        }\r\n    };\r\n\r\n    // ページ移動\r\n    const transitPage = (articleName /*: string */)/*: void */ => {\r\n        const newPage = showCard(articleName)\r\n        history.pushState(null, null, \"?page=\" + newPage)\r\n    };\r\n\r\n    // 各ページ移動ボタンの実装\r\n    const setPageTransitionButtonEvent = (articles /*: string[] */)/*: void */ => {\r\n        forEach(document.querySelectorAll(\".sidebar-item\"), (sidebarItem) => {\r\n            const articleName = sidebarItem.id;\r\n            sidebarItem.addEventListener(\"click\", () => {\r\n                transitPage(articleName)\r\n            });\r\n        });\r\n    };\r\n\r\n    const startLoadingGifAnimation = ()/*: void */ => {\r\n        const secondImage = \"./img/second_background_anime.gif\";\r\n        const img = new Image();\r\n        img.onload = () => {\r\n            // gifアニメのダウンロードが終わったら、デフォルトの背景と入れ替える\r\n            document.querySelector(\"#content\").style.backgroundImage = `url(${secondImage})`;\r\n        };\r\n        // 背景のgifアニメのダウンロードを開始\r\n        img.src = secondImage;\r\n    };\r\n\r\n    const isValidPostContent =\r\n            (titleEl /*: HTMLElement */, bodyEl /*: HTMLElement */)/*: boolean */ => {\r\n        if (!titleEl || !bodyEl) {\r\n            console.error(\"!titleEl || !bodyEl\");\r\n            alert(\"エラーが発生しました。（!titleEl || !bodyEl）\");\r\n            return false;\r\n        }\r\n        if (!titleEl.value.length) {\r\n            alert(\"名前を入力してください。\");\r\n            return false;\r\n        }\r\n        if (titleEl.value.length > 100) {\r\n            alert(\"名前が長すぎます。100文字以下でお願いします。\");\r\n            return false;\r\n        }\r\n        if (!bodyEl.value.length) {\r\n            alert(\"本文を入力してください。\");\r\n            return false;\r\n        }\r\n        if (bodyEl.value.length > 1000) {\r\n            alert(\"本文が長すぎます。1000文字以下でお願いします。\");\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    /* window. */ sendNewPost = () => {\r\n        const titleEl = document.querySelector(\"#title_text\");\r\n        const bodyEl = document.querySelector(\"#body_text\");\r\n        if (!isValidPostContent(titleEl, bodyEl)) {\r\n            return;\r\n        }\r\n\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = () => {\r\n            if (xhr.readyState === 4) {\r\n                console.log(xhr);\r\n                alert(\"送信しました！\");\r\n            }\r\n        };\r\n        xhr.open(\"POST\",\"https://script.google.com/macros/s/AKfycbwsixvFco58E15FhMJEif81z68X8F5ZLrCu1hykKVblh8Eey8o/exec\");\r\n        xhr.send(JSON.stringify({\r\n            command: \"new\",\r\n            title: titleEl.value,\r\n            body: bodyEl.value\r\n        }));\r\n        titleEl.value = \"\";\r\n        bodyEl.value = \"\";\r\n    };\r\n\r\n    // main\r\n    const params = new URLSearchParams(location.search.slice(1))\r\n    if (params.has(\"page\")) {\r\n        transitPage(params.get(\"page\"))\r\n    }\r\n    window.onpopstate = (e) => {\r\n        showCard(new URLSearchParams(location.search.slice(1)).get(\"page\"))\r\n    }\r\n    setPageTransitionButtonEvent(/* window.*/ articles);\r\n    startLoadingGifAnimation();\r\n}\r\n"],"file":"main.js"}